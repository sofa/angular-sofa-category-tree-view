/**
 * angular-sofa-category-tree-view - v0.1.0 - Wed Feb 18 2015 14:37:18 GMT+0100 (CET)
 * http://www.sofa.io
 *
 * Copyright (c) 2014 CouchCommerce GmbH (http://www.couchcommerce.com / http://www.sofa.io) and other contributors
 * THIS SOFTWARE CONTAINS COMPONENTS OF THE SOFA.IO COUCHCOMMERCE SDK (WWW.SOFA.IO)
 * IT IS PROVIDED UNDER THE LICENSE TERMS OF THE ATTACHED LICENSE.TXT.
 */
!function(e){e.module("sofa.categoryTreeView",["sofa.templateCode","sofa.navigationService","sofa-category-tree-view.tpl.html"]),e.module("sofa-category-tree-view.tpl.html",[]).run(["$templateCache",function(e){e.put("sofa-category-tree-view.tpl.html","<div class=\"sofa-category-tree-view\">\n    <ul ng-class=\"{ 'sofa-category-tree-view__list--open': item._categoryTreeView.isVisible,\n                    'sofa-category-tree-view__list--closed': !item._categoryTreeView.isVisible,\n                    'sofa-category-tree-view__list--root': isRoot,\n                    'sofa-category-tree-view__list--child': !isRoot }\" sofa-template-code>\n"+'       <li class="sofa-category-tree-view__list-item" sofa-nested-category-item ng-repeat="item in items">\n           <a href="{{item.getOriginFullUrl()}}" ng-click="doAction($event, item)" class="sofa-category-tree-view__link"\n               ng-class="{ \'sofa-category-tree-view__link--active\': item._categoryTreeView.isActive,\n                           \'sofa-category-tree-view__link--has-children\': item.hasChildren,\n                           \'sofa-category-tree-view__link--open\': item.hasChildren && item._categoryTreeView.isVisible }"\n               ng-bind="item.label">\n            </a>\n       </li>\n    </ul>\n</div>\n')}]),e.module("sofa.categoryTreeView").directive("sofaCategoryTreeView",["couchService","categoryTreeViewRemote",function(e,i){"use strict";return{restrict:"EA",scope:{},replace:!0,templateUrl:"sofa-category-tree-view.tpl.html",link:function(t){e.getCategory().then(function(e){t.items=e&&e.children?e.children:[],t.item=e,t.isRoot=!0,i.toggleVisibility(e),t.items.forEach(function(e){i.setItemLevel(e,1)})})}}}]),e.module("sofa.categoryTreeView").factory("categoryTreeViewRemote",function(){"use strict";var e={},i=null;e.setActive=function(r){t(r),i&&(i._categoryTreeView.isActive=!1),r._categoryTreeView.isActive=!0,e.setVisibility(r,!0,!0),i=r},e.setVisibility=function(i,r,o){t(i),i._categoryTreeView.isVisible=r,i.parent&&o&&e.setVisibility(i.parent,r,o)},e.toggleVisibility=function(e){t(e),e._categoryTreeView.isVisible=!e._categoryTreeView.isVisible},e.setItemLevel=function(e,i){t(e),e._categoryTreeView.level=i};var t=function(e){e._categoryTreeView||(e._categoryTreeView={isVisible:!1})};return e}),e.module("sofa.categoryTreeView").directive("sofaNestedCategoryItem",["$compile","categoryTreeViewRemote","navigationService",function(e,i,t){"use strict";return{restrict:"A",require:"^sofaTemplateCode",link:function(r,o,a,s){if(r.isRoot=!1,r.item.children){r.items=r.item.children;var n=e(s.templateCode)(r);o.append(n)}r.remoteControl=i,r.doAction=function(e,r){e.preventDefault(),r.hasChildren?i.toggleVisibility(r):(i.setActive(r),t.navigateToUrl(r.getOriginFullUrl()))}}}}])}(angular);